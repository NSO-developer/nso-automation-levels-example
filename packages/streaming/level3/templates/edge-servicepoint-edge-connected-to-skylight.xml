<config-template xmlns="http://tail-f.com/ns/config/1.0"
                 servicepoint="edge-servicepoint"
                 componenttype="streaming:edge"
                 state="streaming:connected-to-skylight">
  <?set EDGE = {./name}?>
  <?set DC = {./dc}?>
  <?set SESSION_ID = {./name}-connected-to-skylight?>
  <?set SERVICE_NAME = {./name}-connected-to-skylight?>
  <?set-root-node {/}?>
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>skylight</name>
      <config>
        <sessions xmlns="http://accedian.com/ns/yang/session">
          <session>
            <session-id>{$SESSION_ID}</session-id>
            <session-name>{$SESSION_ID}</session-name>
            <description>{$EDGE} connected to skylight</description>
            <session-type xmlns:acdst="http://accedian.com/ns/yang/session/type">acdst:twamp-light</session-type>

            <!-- Endpoint located in datacenter -->
            <service-endpoints>
              <endpoint-id>{$DC}-agent</endpoint-id>
              <session-protocol>
                <twamp-light xmlns="http://accedian.com/ns/yang/session/twamp/light">
                  <session-sender>
                    <admin-state>true</admin-state>
                    <reflector-udp-port>862</reflector-udp-port>
                  </session-sender>
                </twamp-light>
              </session-protocol>
            </service-endpoints>

            <!-- Endpoint located at vpn endpoint -->
            <service-endpoints>
              <endpoint-id>{$EDGE}-twamp</endpoint-id>
              <session-protocol>
                <twamp-light xmlns="http://accedian.com/ns/yang/session/twamp/light">
                  <session-reflector>
                    <admin-state>true</admin-state>
                    <reflector-udp-port>862</reflector-udp-port>
                    <mode>stateful</mode>
                  </session-reflector>
                </twamp-light>
              </session-protocol>
            </service-endpoints>

            <!-- Meta data -->
            <metadata>
              <key-value>
                <key-name>region</key-name>
                <value>Nordic</value>
              </key-value>
              <key-value>
                <key-name>access_type</key-name>
                <value>Fiber</value>
              </key-value>
            </metadata>
          </session>
        </sessions>
        <services xmlns="http://accedian.com/ns/yang/service">
          <service>
            <service-id>{$SERVICE_NAME}</service-id>
            <service-name>{$SERVICE_NAME}</service-name>
            <description>{$SERVICE_NAME}</description>
            <sessions>
              <session-id>{$SESSION_ID}</session-id>
            </sessions>
            <!--alerts>
              <alert-policy-id>{$ALERT_ID}</alert-policy-id>
            </alerts-->
          </service>
        </services>
      </config>
    </device>
  </devices>
    <devices xmlns="http://tail-f.com/ns/ncs">
      <device>
          <name>{$EDGE}</name>
          <config>
              <twamp xmlns="urn:ietf:params:xml:ns:yang:ietf-twamp">
                  <session-reflector>
                      <admin-state>true</admin-state>
                  </session-reflector>
              </twamp>
          </config>
      </device>
  </devices>
</config-template>
